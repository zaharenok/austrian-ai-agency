// Translation data
const translations = {
    de: {
        // Navigation
        nav: {
            start: "Start",
            about: "Über uns",
            results: "Ergebnisse",
            services: "Leistungen",
            process: "Ablauf",
            contact: "Kontakt"
        },
        // Hero Section
        hero: {
            title: "Mehr Gewinn und weniger Kosten mit KI in Ihrem DACH-Business",
            subtitle: "Ich helfe Unternehmen in Deutschland, Österreich und der Schweiz, innerhalb von 4–8 Wochen praktische KI-Lösungen (OpenAI, Claude, Gemini) zu starten, die Kosten senken, mehr Kunden bringen und Entscheidungen beschleunigen – unter Berücksichtigung lokaler Gesetze und Kultur.",
            cta1: "Kostenlose 30-minütige Strategie-Sitzung",
            cta2: "Projektangebot anfordern"
        },
        // About Section
        about: {
            title: "Wer wir sind",
            intro: "Austrian AI Agency – Ihr Partner für KI-Implementierung mit klarem Business-Ergebnis",
            description1: "Wir sind Austrian AI Agency, Ihr Partner für die Implementierung künstlicher Intelligenz für messbares Geschäftswachstum in der DACH-Region.",
            description2: "Ich arbeite als offiziell lizenzierter Unternehmensberater in Österreich und kombiniere jahrelange Erfahrung in IT, Automatisierung und Business-Management. Deshalb verstehe ich gleichermassen gut: wie moderne KI-Modelle funktionieren (OpenAI, Claude, Gemini usw.) und welche Beschränkungen, Risiken und Anforderungen Unternehmen in Deutschland, Österreich und der Schweiz haben.",
            description3: "Meine Aufgabe ist nicht \"KI um der KI willen\", sondern: Ihnen zu zeigen, wo genau KI Ihnen Geld bringt; den wirtschaftlichen Nutzen und Risiken zu berechnen; Lösungen zu entwerfen und zu implementieren, die in Ihrem Unternehmen wirklich funktionieren.",
            license_title: "Offiziell lizenzierter Unternehmensberater",
            license_desc: "Gewerbeberechtigung in Österreich",
            focus_title: "Fokus auf DACH-Markt",
            focus_desc: "Lokale Expertise & kulturelles Verständnis",
            expertise_title: "Tiefe Praxis-Erfahrung",
            expertise_desc: "OpenAI, Claude, Gemini & mehr"
        },
        // Results Section
        results: {
            title: "Welche Ergebnisse Sie von der KI-Implementierung erwarten können",
            costs: {
                title: "Bis zu 40% Kostensenkung durch Automatisierung",
                description: "Eliminieren Sie manuelle Routine: Antragsbearbeitung, Dateneingabe, Antworten auf Standardfragen, Dokumentenerstellung. Mitarbeiter gewinnen 20–40% Zeit zurück und konzentrieren sich auf profitable Aufgaben."
            },
            revenue: {
                title: "Bis zu 25% Umsatzwachstum durch KI-Marketing",
                description: "Personalisierte E-Mails und Nachrichten, KI-gestützte Lead-Priorisierung, automatisierte Vertriebsprozesse. Ziel: Conversion-Steigerung von 3% auf 8–12% in Schlüsselbereichen der Pipeline."
            },
            decisions: {
                title: "10x schneller Management-Entscheidungen",
                description: "Realtime-Dashboards, automatisierte Markt- und Kundendatenanalyse, prädiktive Umsatz- und Risikoanalyse. Antworten in Minuten statt Wochen, schnellere Reaktion auf Marktveränderungen."
            },
            products: {
                title: "2–3x schneller Produktlaunches",
                description: "KI-unterstützte Ideengenerierung, Nachfrageanalyse, Präsentationen und Landingpages, schnelles Prototyping. Unser Ziel: Neue Produkte in 2–3 Monaten statt 6–9 testen."
            },
            service: {
                title: "24/7 Kundenservice ohne Personalwachstum",
                description: "Intelligente Chatbots und Assistenten lösen 70–80% der Standardanfragen automatisch, reduzieren die Teamauslastung und erhöhen die Kundenzufriedenheit spürbar."
            },
            compliance: {
                title: "100% GDPR-Fokus und Risikominimierung",
                description: "GDPR-kompatible Lösungsentwicklung: Datenminimierung, Zugriffskontrolle, Protokollierung. Minimierung rechtlicher Risiken und Schutz Ihrer Unternehmensreputation."
            }
        },
        // Services Section
        services: {
            title: "Wie Ihr Unternehmen mit KI schneller wächst",
            efficiency: {
                title: "40% Kostenreduktion durch Automatisierung",
                description: "Eliminieren Sie manuelle Routineaufgaben und sparen Sie jährlich 100.000+ € bei gleichbleibender Qualität. Ihre Mitarbeiter konzentrieren sich auf wertschöpfende Tätigkeiten."
            },
            customers: {
                title: "25% mehr Umsatz durch KI-Marketing",
                description: "Personalisierte Kundenansprache, prädiktive Lead-Qualifizierung und automatisierte Vertriebsprozesse. Konvertierungssteigerung von 3% auf 12% innerhalb von 90 Tagen."
            },
            decisions: {
                title: "10x schnellere Entscheidungsfindung",
                description: "Realtime-Dashboards, automatisierte Marktanalyse und prädiktive Business-Intelligence. Keine monatelangen Reports mehr – Entscheidungen auf Knopfdruck in Minuten statt Wochen."
            },
            innovation: {
                title: "3x schnellere Produktentwicklung",
                description: "KI-gestützte Ideenfindung, automatisierte Prototypen-Erstellung und Marktanalyse. Launch neuer Produkte in 3 Monaten statt 9 bei doppelter Erfolgsquote."
            },
            service: {
                title: "24/7 Premium-Kundenservice",
                description: "Intelligente Chatbots, automatisierte Ticketverteilung und proaktives Kundenmanagement. 80% der Anfragen automatisch lösen, Kunden satisfaction um 45% steigern."
            },
            compliance: {
                title: "100% DSGVO-Konformität & Risikominimierung",
                description: "Automatisierte Compliance-Prüfungen, Dokumentation und Risiko-Monitoring. Vermeiden Sie 250.000 € Bußgelder und schützen Sie Ihre Reputation proaktiv."
            }
        },
        // Why Section
        why: {
            title: "Warum mit mir",
            license: {
                title: "Offiziell lizenzierter Unternehmensberater",
                description: "Kein \"IT-Träumer\" – sondern zertifizierter Berater mit rechtlicher Grundlage für professionelle Beratungstätigkeit in Österreich."
            },
            local: {
                title: "Fokus auf DACH-Markt und lokale Besonderheiten",
                description: "Ich verstehe die mentalen Modelle, Geschäftspraktiken und regulatorischen Anforderungen im deutschsprachigen Raum."
            },
            tech: {
                title: "Tiefe Praxis mit OpenAI, Anthropic Claude, Google Gemini",
                description: "Hands-on Erfahrung mit allen führenden KI-Plattformen – von der API-Integration bis zur Fine-Tuning von Modellen."
            },
            business: {
                title: "Kombination aus Technik- und Business-Know-how",
                description: "Ich spreche sowohl die Sprache der Entwickler als auch die der Geschäftsführung – übersetze technisches Potenzial in business value."
            },
            premium: {
                title: "Premium-Ansatz: wenige Kunden, hoher Impact",
                description: "Ich arbeite gezielt mit einer ausgewählten Anzahl an Kunden, um maximale Wirkung und nachhaltige Ergebnisse zu erzielen."
            }
        },
        // Process Section
        process: {
            title: "So läuft unsere Zusammenarbeit ab",
            step1: {
                title: "Analyse & Zielbild",
                description: "60–90-minütiges Erstgespräch, Prozess-Audit, Definition konkreter Ziele und Erwartungen. Gemeinsam erarbeiten wir ein klares Bild vom Ist-Zustand und den gewünschten Zielen."
            },
            step2: {
                title: "Prototyp & Tests",
                description: "Schnelle Entwicklung von KI-Prototypen und gezielte Experimente innerhalb von 2–4 Wochen. Wir testen Hypothesen mit minimalem Risiko und maximalem Lerneffekt."
            },
            step3: {
                title: "Rollout & Begleitung",
                description: "Skalierung erfolgreicher Lösungen, Implementierung in den produktiven Betrieb, Schulung Ihres Teams und kontinuierliche Optimierung der KI-Systeme."
            }
        },
        // Social Proof Section
        proof: {
            title: "Ausgewählte Kunden & Projekte",
            description: "Ich arbeite mit einer ausgewählten Kundengruppe aus verschiedenen Branchen im DACH-Raum zusammen. Hier eine kleine Auswahl erfolgreicher Kooperationen (Detailed Case Studies folgen in Kürze):",
            case1: {
                title: "Mittelständisches Produktionsunternehmen",
                description: "KI-gestützte Qualitätskontrolle und vorausschauende Wartung"
            },
            case2: {
                title: "Finanzdienstleister",
                description: "Automatisierung von Dokumenten-Verarbeitung und Risiko-Analyse"
            },
            case3: {
                title: "E-Commerce Unternehmen",
                description: "KI-optimierter Kundenservice und personalisierte Produkt-Empfehlungen"
            }
        },
        // Contact Section
        contact: {
            title: "Bereit, KI in Ihrem Unternehmen wirklich zu nutzen?",
            subtitle: "Lernen Sie sich in einem kostenlosen 30-minütigen Strategie-Call kennen und entdecken Sie das KI-Potenzial für Ihr Unternehmen.",
            name_label: "Name *",
            company_label: "Unternehmen *",
            email_label: "E-Mail *",
            challenge_label: "Ihre Herausforderung (kurz beschrieben)",
            submit: "Strategie-Call anfragen",
            email_title: "E-Mail",
            phone_title: "Telefon",
            location_title: "Standort",
            location_value: "Wien, Österreich",
            languages_title: "Sprachen",
            languages_value: "Deutsch, Englisch, Russisch"
        },
        // Footer
        footer: {
            rights: "Alle Rechte vorbehalten."
        }
    },
    ru: {
        // Navigation
        nav: {
            start: "Главная",
            about: "Обо мне",
            services: "Услуги",
            process: "Процесс",
            contact: "Контакты"
        },
        // Hero Section
        hero: {
            title: "Ваш персональный проводник в мир искусственного интеллекта в регионе DACH",
            subtitle: "Я помогаю компаниям в Германии, Австрии и Швейцарии целенаправленно использовать ИИ вроде OpenAI, Claude и Gemini для автоматизации процессов, снижения затрат и ускорения принятия лучших решений.",
            cta1: "Бесплатная первичная консультация",
            cta2: "Отправить запрос на проект"
        },
        // About Section
        about: {
            title: "Кто я",
            intro: "Мы – Austrian AI Agency, ваш партнер по внедрению ИИ для измеримого роста бизнеса в DACH.",
            description1: "С официальной лицензией бизнес-консультанта в Австрии и многолетним опытом в IT, автоматизации и бизнесе, я понимаю как технические возможности, так и бизнес-требования компаний в регионе DACH.",
            description2: "Моя миссия: сделать сложные ИИ-решения понятными и помочь компаниям раскрыть свой полный потенциал через целенаправленное использование ИИ.",
            license_title: "Официально лицензированный бизнес-консультант",
            license_desc: "Лицензия на предпринимательскую деятельность в Австрии",
            focus_title: "Фокус на рынок DACH",
            focus_desc: "Локальная экспертиза и культурное понимание",
            expertise_title: "Глубокий практический опыт",
            expertise_desc: "OpenAI, Claude, Gemini и многое другое"
        },
        // Services Section
        services: {
            title: "Как ваша компания растет с помощью ИИ",
            efficiency: {
                title: "40% сокращение издержек через автоматизацию",
                description: "Устраните ручные рутинные задачи и экономьте 100.000+ € в год при сохранении качества. Ваши сотрудники сфокусируются на создании ценности."
            },
            customers: {
                title: "25% больше выручки через ИИ-маркетинг",
                description: "Персонализированное общение с клиентами, предиктивная квалификация лидов и автоматизация продаж. Рост конверсии с 3% до 12% за 90 дней."
            },
            decisions: {
                title: "10x ускорение принятия решений",
                description: "Дашборды в реальном времени, автоматизированная анализ рынка и предиктивная бизнес-аналитика. Никаких отчетов месяцами – решения за минуты вместо недель."
            },
            innovation: {
                title: "3x ускорение разработки продуктов",
                description: "Генерация идей с ИИ, автоматизированное создание прототипов и анализ рынка. Запуск новых продуктов за 3 месяца вместо 9 при двойной доле успеха."
            },
            service: {
                title: "24/7 премиум-поддержка клиентов",
                description: "Интеллектуальные чат-боты, автоматизированное распределение заявок и проактивный клиентский менеджмент. 80% запросов решаются автоматически, удовлетворенность клиентов растет на 45%."
            },
            compliance: {
                title: "100% GDPR-соответствие и минимизация рисков",
                description: "Автоматизированные проверки комплаенса, документация и мониторинг рисков. Избегайте штрафов 250.000 € и защитите репутацию проактивно."
            }
        },
        // Why Section
        why: {
            title: "Почему со мной",
            license: {
                title: "Официально лицензированный бизнес-консультант",
                description: "Не \"IT-мечтатель\" – а сертифицированный консультант с правовой основой для профессиональной консалтинговой деятельности в Австрии."
            },
            local: {
                title: "Фокус на рынок DACH и местные особенности",
                description: "Я понимаю ментальные модели, деловые практики и регуляторные требования в немецкоязычном регионе."
            },
            tech: {
                title: "Глубокая практика с OpenAI, Anthropic Claude, Google Gemini",
                description: "Практический опыт со всеми ведущими ИИ-платформами – от API-интеграции до тонкой настройки моделей."
            },
            business: {
                title: "Комбинация технических и бизнес-знаний",
                description: "Я говорю на языке как разработчиков, так и руководителей – преобразую технический потенциал в бизнес-ценность."
            },
            premium: {
                title: "Премиальный подход: мало клиентов, высокий импакт",
                description: "Я целенаправленно работаю с отобранным количеством клиентов для достижения максимального эффекта и устойчивых результатов."
            }
        },
        // Process Section
        process: {
            title: "Как проходит наше сотрудничество",
            step1: {
                title: "Анализ и целевое видение",
                description: "60-90-минутная первичная консультация, аудит процессов, определение конкретных целей и ожиданий. Вместе мы создаем четкую картину текущего состояния и желаемых целей."
            },
            step2: {
                title: "Прототип и тесты",
                description: "Быстрая разработка ИИ-прототипов и целенаправленные эксперименты в течение 2-4 недель. Мы тестируем гипотезы с минимальным риском и максимальным обучающим эффектом."
            },
            step3: {
                title: "Внедрение и сопровождение",
                description: "Масштабирование успешных решений, внедрение в производственную эксплуатацию, обучение вашей команды и непрерывная оптимизация ИИ-систем."
            }
        },
        // Social Proof Section
        proof: {
            title: "Избранные клиенты и проекты",
            description: "Я работаю с отобранной группой клиентов из различных отраслей в регионе DACH. Вот небольшой выбор успешных сотрудничеств (подробные кейсы скоро появятся):",
            case1: {
                title: "Среднее производственное предприятие",
                description: "Контроль качества с поддержкой ИИ и предиктивное обслуживание"
            },
            case2: {
                title: "Финансовые услуги",
                description: "Автоматизация обработки документов и анализ рисков"
            },
            case3: {
                title: "E-commerce компания",
                description: "Оптимизированный с ИИ клиентский сервис и персонализированные рекомендации продуктов"
            }
        },
        // Contact Section
        contact: {
            title: "Готовы по-настоящему использовать ИИ в вашей компании?",
            subtitle: "Познакомьтесь со мной на бесплатной 30-минутной стратегической сессии и откройте ИИ-потенциал для вашей компании.",
            name_label: "Имя *",
            company_label: "Компания *",
            email_label: "E-mail *",
            challenge_label: "Ваша задача (краткое описание)",
            submit: "Запросить стратегическую сессию",
            email_title: "E-mail",
            phone_title: "Телефон",
            location_title: "Местоположение",
            location_value: "Вена, Австрия",
            languages_title: "Языки",
            languages_value: "Немецкий, английский, русский"
        },
        // Footer
        footer: {
            rights: "Все права защищены."
        }
    },
    en: {
        // Navigation
        nav: {
            start: "Home",
            about: "About Me",
            services: "Services",
            process: "Process",
            contact: "Contact"
        },
        // Hero Section
        hero: {
            title: "Your Personal Guide to the World of Artificial Intelligence in the DACH Region",
            subtitle: "I help companies in Germany, Austria, and Switzerland to strategically use AI like OpenAI, Claude, and Gemini to automate processes, reduce costs, and make better decisions faster.",
            cta1: "Book Free Initial Consultation",
            cta2: "Send Project Inquiry"
        },
        // About Section
        about: {
            title: "Who I Am",
            intro: "We're Austrian AI Agency – your AI partner for measurable growth in the DACH region.",
            description1: "With an official business consulting license in Austria and years of experience in IT, automation, and business, I understand both the technical possibilities and the business requirements of companies in the DACH region.",
            description2: "My mission: To make complex AI solutions understandable and help companies unlock their full potential through targeted AI implementation.",
            license_title: "Officially Licensed Business Consultant",
            license_desc: "Business license in Austria",
            focus_title: "Focus on DACH Market",
            focus_desc: "Local expertise & cultural understanding",
            expertise_title: "Deep Practical Experience",
            expertise_desc: "OpenAI, Claude, Gemini & more"
        },
        // Services Section
        services: {
            title: "How Your Company Grows Faster with AI",
            efficiency: {
                title: "40% Cost Reduction through Automation",
                description: "Eliminate manual routine tasks and save 100,000+ € annually while maintaining quality. Your employees focus on value-creating activities."
            },
            customers: {
                title: "25% More Revenue through AI Marketing",
                description: "Personalized customer engagement, predictive lead qualification, and automated sales processes. Conversion increase from 3% to 12% within 90 days."
            },
            decisions: {
                title: "10x Faster Decision-Making",
                description: "Real-time dashboards, automated market analysis, and predictive business intelligence. No more month-long reports – decisions at the push of a button in minutes instead of weeks."
            },
            innovation: {
                title: "3x Faster Product Development",
                description: "AI-powered idea generation, automated prototype creation, and market analysis. Launch new products in 3 months instead of 9 with double success rates."
            },
            service: {
                title: "24/7 Premium Customer Service",
                description: "Intelligent chatbots, automated ticket distribution, and proactive customer management. Resolve 80% of requests automatically, increase customer satisfaction by 45%."
            },
            compliance: {
                title: "100% GDPR Compliance & Risk Minimization",
                description: "Automated compliance checks, documentation, and risk monitoring. Avoid 250,000 € fines and protect your reputation proactively."
            }
        },
        // Why Section
        why: {
            title: "Why Work With Me",
            license: {
                title: "Officially Licensed Business Consultant",
                description: "Not an \"IT dreamer\" – but a certified consultant with legal basis for professional consulting activities in Austria."
            },
            local: {
                title: "Focus on DACH Market and Local Particularities",
                description: "I understand the mental models, business practices, and regulatory requirements in the German-speaking region."
            },
            tech: {
                title: "Deep Practice with OpenAI, Anthropic Claude, Google Gemini",
                description: "Hands-on experience with all leading AI platforms – from API integration to fine-tuning models."
            },
            business: {
                title: "Combination of Technical and Business Know-How",
                description: "I speak both the language of developers and that of management – translating technical potential into business value."
            },
            premium: {
                title: "Premium Approach: Few Clients, High Impact",
                description: "I work selectively with a selected number of clients to achieve maximum impact and sustainable results."
            }
        },
        // Process Section
        process: {
            title: "How Our Collaboration Works",
            step1: {
                title: "Analysis & Target Vision",
                description: "60-90-minute initial consultation, process audit, definition of concrete goals and expectations. Together we create a clear picture of the current state and desired goals."
            },
            step2: {
                title: "Prototype & Tests",
                description: "Fast development of AI prototypes and targeted experiments within 2-4 weeks. We test hypotheses with minimal risk and maximum learning effect."
            },
            step3: {
                title: "Rollout & Support",
                description: "Scaling successful solutions, implementation into productive operation, training your team, and continuous optimization of AI systems."
            }
        },
        // Social Proof Section
        proof: {
            title: "Selected Customers & Projects",
            description: "I work with a selected group of clients from various industries in the DACH region. Here is a small selection of successful collaborations (detailed case studies follow soon):",
            case1: {
                title: "Medium-Sized Production Company",
                description: "AI-supported quality control and predictive maintenance"
            },
            case2: {
                title: "Financial Services Provider",
                description: "Automation of document processing and risk analysis"
            },
            case3: {
                title: "E-commerce Company",
                description: "AI-optimized customer service and personalized product recommendations"
            }
        },
        // Contact Section
        contact: {
            title: "Ready to Really Use AI in Your Company?",
            subtitle: "Get to know me in a free 30-minute strategy call and discover the AI potential for your company.",
            name_label: "Name *",
            company_label: "Company *",
            email_label: "Email *",
            challenge_label: "Your Challenge (brief description)",
            submit: "Request Strategy Call",
            email_title: "Email",
            phone_title: "Phone",
            location_title: "Location",
            location_value: "Vienna, Austria",
            languages_title: "Languages",
            languages_value: "German, English, Russian"
        },
        // Footer
        footer: {
            rights: "All rights reserved."
        }
    }
};

// Current language state
let currentLanguage = detectUserLanguage();

// Detect user language based on browser/IP
function detectUserLanguage() {
    // Try to get language from browser
    const browserLang = navigator.language || navigator.userLanguage;

    // Extract primary language code (e.g., 'de' from 'de-DE')
    const primaryLang = browserLang.toLowerCase().split('-')[0];

    // Map languages to our supported languages
    const langMap = {
        'de': 'de',  // German
        'ru': 'ru',  // Russian
        'en': 'en',  // English
        'fr': 'en',  // French -> English (fallback)
        'it': 'en',  // Italian -> English (fallback)
        'es': 'en',  // Spanish -> English (fallback)
        'pl': 'de',  // Polish -> German (DACH region)
        'cz': 'de',  // Czech -> German (DACH region)
        'hu': 'de',  // Hungarian -> German (DACH region)
        'sk': 'de',  // Slovak -> German (DACH region)
        'sl': 'de'   // Slovenian -> German (DACH region)
    };

    return langMap[primaryLang] || 'de'; // Default to German for DACH
}

// Initialize the website
document.addEventListener('DOMContentLoaded', function() {
    initializeWebsite();
    updateLanguageDisplay();
});

function initializeWebsite() {
    setupLanguageSwitcher();
    setupNavigation();
    setupMobileMenu();
    setupSmoothScrolling();
    setupFormHandling();
    setupScrollEffects();
    updateLanguage(currentLanguage);
}

// Language switcher functionality
// Update language display
function updateLanguageDisplay() {
    const currentLangSpan = document.getElementById('currentLang');
    if (currentLangSpan) {
        currentLangSpan.textContent = currentLanguage.toUpperCase();
    }

    // Update active state in language options
    const langOptions = document.querySelectorAll('.lang-option');
    langOptions.forEach(opt => opt.classList.remove('active'));

    const activeOption = document.querySelector(`.lang-option[data-lang="${currentLanguage}"]`);
    if (activeOption) {
        activeOption.classList.add('active');
    }
}

function setupLanguageSwitcher() {
    const languageToggle = document.getElementById('languageToggle');
    const languageOptions = document.getElementById('languageOptions');
    const currentLangSpan = document.getElementById('currentLang');

    if (!languageToggle || !languageOptions || !currentLangSpan) {
        console.error('Language switcher elements not found');
        return;
    }

    // Toggle dropdown
    languageToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        const isOpen = languageOptions.classList.contains('show');

        if (isOpen) {
            closeLanguageDropdown();
        } else {
            openLanguageDropdown();
        }
    });

    // Handle language selection - use event delegation
    languageOptions.addEventListener('click', function(e) {
        e.stopPropagation();
        const target = e.target.closest('.lang-option');

        if (target) {
            const lang = target.getAttribute('data-lang');
            console.log('Language selected:', lang); // Debug log

            if (lang && lang !== currentLanguage) {
                // Update current language
                currentLanguage = lang;

                // Update display
                currentLangSpan.textContent = lang.toUpperCase();

                // Update active state
                const allOptions = languageOptions.querySelectorAll('.lang-option');
                allOptions.forEach(opt => opt.classList.remove('active'));
                target.classList.add('active');

                // Update language content
                updateLanguage(lang);
                console.log('Language updated to:', lang); // Debug log
            }

            closeLanguageDropdown();
        }
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', closeLanguageDropdown);

    // Close dropdown when pressing Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeLanguageDropdown();
        }
    });
}

function openLanguageDropdown() {
    const languageOptions = document.getElementById('languageOptions');
    const languageToggle = document.getElementById('languageToggle');

    if (languageOptions && languageToggle) {
        languageOptions.classList.add('show');
        languageToggle.classList.add('active');
    }
}

function closeLanguageDropdown() {
    const languageOptions = document.getElementById('languageOptions');
    const languageToggle = document.getElementById('languageToggle');

    if (languageOptions && languageToggle) {
        languageOptions.classList.remove('show');
        languageToggle.classList.remove('active');
    }
}

// Update language content
function updateLanguage(lang) {
    // Update HTML lang attribute
    document.documentElement.lang = lang;

    // Update all elements with data-i18n attribute
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(element => {
        const key = element.getAttribute('data-i18n');
        const translation = getNestedTranslation(translations[lang], key);

        if (translation) {
            element.textContent = translation;
        }
    });

    // Update page title
    updatePageTitle(lang);
}

// Get nested translation from object
function getNestedTranslation(obj, key) {
    return key.split('.').reduce((nested, part) => {
        return nested && nested[part] ? nested[part] : null;
    }, obj);
}

// Update page title based on language
function updatePageTitle(lang) {
    const titles = {
        de: 'Austrian AI Agency - KI-Lösungen für DACH-Unternehmen',
        ru: 'Austrian AI Agency - ИИ-решения для компаний DACH',
        en: 'Austrian AI Agency - AI Solutions for DACH Companies'
    };
    document.title = titles[lang];
}

// Navigation functionality
function setupNavigation() {
    // Add smooth scrolling to navigation links
    const navLinks = document.querySelectorAll('.nav-link');

    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            if (targetId && targetId !== '#') {
                const targetSection = document.querySelector(targetId);
                if (targetSection) {
                    const offset = 80; // Offset for fixed navigation
                    const targetPosition = targetSection.offsetTop - offset;

                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });

                    // Update active state
                    updateActiveNavLink(targetId);
                }
            }
        });
    });
}

// Mobile menu functionality
function setupMobileMenu() {
    const hamburger = document.querySelector('.hamburger');
    const navMenu = document.querySelector('.nav-menu');

    if (hamburger && navMenu) {
        hamburger.addEventListener('click', function() {
            this.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        // Close mobile menu when clicking on a link
        const navLinks = document.querySelectorAll('.nav-link');
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                hamburger.classList.remove('active');
                navMenu.classList.remove('active');
            });
        });
    }
}

// Smooth scrolling function for buttons
function scrollToSection(sectionId) {
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        const offset = 80;
        const targetPosition = targetSection.offsetTop - offset;

        window.scrollTo({
            top: targetPosition,
            behavior: 'smooth'
        });

        updateActiveNavLink(`#${sectionId}`);
    }
}

// Update active navigation link based on scroll position
function updateActiveNavLink(targetId) {
    const navLinks = document.querySelectorAll('.nav-link');

    navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === targetId) {
            link.classList.add('active');
        }
    });
}

// Setup scroll effects
function setupScrollEffects() {
    // Update navbar on scroll
    window.addEventListener('scroll', function() {
        const navbar = document.getElementById('navbar');
        if (window.scrollY > 100) {
            navbar.style.background = 'rgba(255, 255, 255, 0.98)';
            navbar.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.1)';
        } else {
            navbar.style.background = 'rgba(255, 255, 255, 0.95)';
            navbar.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.08)';
        }

        // Update active navigation based on scroll position
        updateActiveNavOnScroll();
    });
}

// Update active navigation based on scroll position
function updateActiveNavOnScroll() {
    const sections = document.querySelectorAll('section[id]');
    const scrollY = window.pageYOffset;

    sections.forEach(section => {
        const sectionHeight = section.offsetHeight;
        const sectionTop = section.offsetTop - 100;
        const sectionId = section.getAttribute('id');

        if (scrollY > sectionTop && scrollY <= sectionTop + sectionHeight) {
            updateActiveNavLink(`#${sectionId}`);
        }
    });
}

// Form handling
function setupFormHandling() {
    const contactForm = document.getElementById('contactForm');

    if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
            e.preventDefault();

            // Get form data
            const formData = new FormData(this);
            const data = Object.fromEntries(formData);

            // Basic validation
            if (!data.name || !data.company || !data.email) {
                showFormMessage('Bitte füllen Sie alle Pflichtfelder aus.', 'error');
                return;
            }

            if (!isValidEmail(data.email)) {
                showFormMessage('Bitte geben Sie eine gültige E-Mail-Adresse ein.', 'error');
                return;
            }

            // Show success message (in real implementation, you would send the data to a server)
            showFormMessage('Vielen Dank für Ihre Anfrage! Ich werde mich so schnell wie möglich bei Ihnen melden.', 'success');

            // Reset form
            this.reset();
        });
    }
}

// Email validation
function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}

// Show form message
function showFormMessage(message, type) {
    // Create or update message element
    let messageElement = document.querySelector('.form-message');

    if (!messageElement) {
        messageElement = document.createElement('div');
        messageElement.className = 'form-message';
        document.querySelector('.contact-form-container').appendChild(messageElement);
    }

    messageElement.textContent = message;
    messageElement.className = `form-message ${type}`;

    // Style the message
    messageElement.style.cssText = `
        padding: 1rem;
        margin-top: 1rem;
        border-radius: 0.5rem;
        font-weight: 500;
        text-align: center;
        animation: slideIn 0.3s ease-out;
    `;

    if (type === 'success') {
        messageElement.style.background = 'var(--accent-light)';
        messageElement.style.color = 'var(--accent-color)';
        messageElement.style.border = '1px solid var(--accent-color)';
    } else {
        messageElement.style.background = '#fef2f2';
        messageElement.style.color = '#dc2626';
        messageElement.style.border = '1px solid #fca5a5';
    }

    // Remove message after 5 seconds
    setTimeout(() => {
        if (messageElement && messageElement.parentNode) {
            messageElement.style.animation = 'slideOut 0.3s ease-out';
            setTimeout(() => {
                if (messageElement.parentNode) {
                    messageElement.parentNode.removeChild(messageElement);
                }
            }, 300);
        }
    }, 5000);
}

// Add slide animations to CSS
const styleSheet = document.createElement('style');
styleSheet.textContent = `
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slideOut {
        from {
            opacity: 1;
            transform: translateY(0);
        }
        to {
            opacity: 0;
            transform: translateY(-10px);
        }
    }

    .hamburger.active .bar:nth-child(1) {
        transform: rotate(-45deg) translate(-5px, 6px);
    }

    .hamburger.active .bar:nth-child(2) {
        opacity: 0;
    }

    .hamburger.active .bar:nth-child(3) {
        transform: rotate(45deg) translate(-5px, -6px);
    }
`;
document.head.appendChild(styleSheet);